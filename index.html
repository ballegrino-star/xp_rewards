<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Class XP 3D Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Load the <model-viewer> web component -->
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

  <style>
    :root {
      --bg: #0f172a;         /* slate-900 */
      --bg-alt: #111827;     /* slightly different dark */
      --accent: #3b82f6;     /* blue-500 */
      --accent-soft: #1d4ed8;/* blue-700 */
      --text: #e5e7eb;       /* gray-200 */
      --muted: #9ca3af;      /* gray-400 */
      --card: #020617;       /* slate-950 */
      --danger: #f97373;     /* red-400 */
      --success: #4ade80;    /* green-400 */
      --warning: #facc15;    /* yellow-400 */
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      background: radial-gradient(circle at top, #1d2951, #020617 60%);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: stretch;
      padding: 16px;
    }

    .app {
      display: grid;
      grid-template-columns: 260px minmax(0, 1fr);
      gap: 16px;
      width: 100%;
      max-width: 1200px;
    }

    .panel {
      background: linear-gradient(135deg, rgba(15,23,42,.95), rgba(15,23,42,.9));
      border-radius: 16px;
      border: 1px solid rgba(148,163,184,0.35);
      box-shadow: 0 20px 40px rgba(0,0,0,0.6);
      padding: 16px;
      backdrop-filter: blur(18px);
    }

    .panel-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
    }

    .panel-title {
      font-size: 1rem;
      font-weight: 700;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      color: var(--muted);
    }

    .badge {
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      border: 1px solid rgba(148,163,184,0.4);
      color: var(--muted);
    }

    /* LEFT: student list */
    .student-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
      max-height: calc(100vh - 32px);
      overflow-y: auto;
      padding-right: 4px;
    }

    .student-search {
      width: 100%;
      margin-bottom: 8px;
    }

    .student-search input {
      width: 100%;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.4);
      background: rgba(15,23,42,0.9);
      color: var(--text);
      font-size: 0.8rem;
    }

    .student-pill {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 10px;
      border-radius: 999px;
      background: rgba(15,23,42,0.9);
      border: 1px solid transparent;
      cursor: pointer;
      transition: all 0.15s ease-out;
      font-size: 0.8rem;
    }

    .student-pill:hover {
      border-color: rgba(59,130,246,0.8);
      background: rgba(15,23,42,1);
      transform: translateY(-1px);
    }

    .student-pill.active {
      background: linear-gradient(90deg, rgba(59,130,246,0.12), rgba(56,189,248,0.08));
      border-color: var(--accent);
    }

    .student-name {
      font-weight: 600;
    }

    .student-meta {
      display: flex;
      gap: 6px;
      align-items: center;
      font-size: 0.7rem;
      color: var(--muted);
    }

    .tier-chip {
      padding: 2px 6px;
      border-radius: 999px;
      font-size: 0.65rem;
      border: 1px solid rgba(148,163,184,0.4);
    }

    .tier-S { border-color: #facc15; color: #facc15; }
    .tier-A { border-color: #4ade80; color: #4ade80; }
    .tier-B { border-color: #60a5fa; color: #60a5fa; }
    .tier-C { border-color: #f97316; color: #f97316; }

    /* RIGHT panel */
    .details-layout {
      display: grid;
      grid-template-rows: minmax(0, 1fr) auto;
      gap: 12px;
      height: calc(100vh - 32px);
    }

    .viewer-card {
      background: radial-gradient(circle at top, rgba(37,99,235,0.25), rgba(2,6,23,0.98));
      border-radius: 16px;
      border: 1px solid rgba(59,130,246,0.4);
      overflow: hidden;
      position: relative;
    }

    model-viewer {
      width: 100%;
      height: 100%;
      background: transparent;
    }

    .viewer-overlay {
      position: absolute;
      top: 8px;
      left: 10px;
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 0.7rem;
    }

    .viewer-overlay .tag {
      padding: 2px 8px;
      border-radius: 999px;
      background: rgba(15,23,42,0.7);
      border: 1px solid rgba(148,163,184,0.4);
    }

    .info-card {
      background: var(--card);
      border-radius: 14px;
      padding: 12px;
      border: 1px solid rgba(148,163,184,0.35);
      display: grid;
      grid-template-columns: minmax(0, 1.3fr) minmax(0,1fr);
      gap: 12px;
      align-items: center;
    }

    .info-main-title {
      font-size: 1.1rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .info-subtitle {
      font-size: 0.8rem;
      color: var(--muted);
      margin-bottom: 6px;
    }

    .xp-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-size: 0.8rem;
      margin-bottom: 4px;
    }

    .xp-bar-bg {
      height: 6px;
      border-radius: 999px;
      background: rgba(30,64,175,0.6);
      overflow: hidden;
      margin-top: 4px;
    }

    .xp-bar-fill {
      height: 100%;
      width: 0;
      border-radius: 999px;
      background: linear-gradient(90deg, #22c55e, #facc15, #f97316);
      transition: width 0.4s ease-out;
    }

    .stat-chip {
      padding: 4px 8px;
      border-radius: 10px;
      font-size: 0.7rem;
      background: rgba(15,23,42,0.9);
      border: 1px solid rgba(148,163,184,0.4);
      margin-bottom: 4px;
    }

    .stat-chip strong {
      color: var(--text);
    }

    .notes {
      font-size: 0.75rem;
      color: var(--muted);
    }

    @media (max-width: 900px) {
      body {
        padding: 8px;
      }
      .app {
        grid-template-columns: 1fr;
      }
      .details-layout {
        height: auto;
      }
      .viewer-card {
        height: 320px;
      }
      .info-card {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- LEFT: student list -->
    <div class="panel">
      <div class="panel-header">
        <div class="panel-title">Students</div>
        <div class="badge">XP Leaderboard</div>
      </div>

      <div class="student-search">
        <input id="searchInput" type="text" placeholder="Search by name..." />
      </div>

      <div id="studentList" class="student-list">
        <!-- Filled by JS -->
      </div>
    </div>

    <!-- RIGHT: 3D viewer + details -->
    <div class="panel">
      <div class="panel-header">
        <div class="panel-title">Profile</div>
        <div class="badge">Interactive 3D Avatar</div>
      </div>

      <div class="details-layout">
        <div class="viewer-card">
          <model-viewer id="avatarViewer"
                        src=""
                        alt="Student avatar"
                        camera-controls
                        auto-rotate
                        rotation-per-second="30deg"
                        shadow-intensity="1"
                        exposure="1"
                        disable-zoom="false"
                        autoplay>
          </model-viewer>
          <div class="viewer-overlay">
            <div class="tag" id="viewerTierTag">Tier: —</div>
            <div class="tag" id="viewerNameTag">Select a student</div>
          </div>
        </div>

        <div class="info-card">
          <div>
            <div class="info-main-title">
              <span id="infoName">No student selected</span>
              <span id="infoTierChip" class="tier-chip">Tier —</span>
            </div>
            <div id="infoSubtitle" class="info-subtitle">
              Click a student on the left to view their 3D avatar and stats.
            </div>

            <div class="xp-row">
              <span>XP</span>
              <span id="infoXp">—</span>
            </div>
            <div class="xp-bar-bg">
              <div id="xpBarFill" class="xp-bar-fill"></div>
            </div>
          </div>

          <div>
            <div id="statTier" class="stat-chip">Tier: —</div>
            <div id="statPaAvg" class="stat-chip">PA Avg: —</div>
            <div id="statNotes" class="notes">
              Use this space for short notes like:
              “On-task streak”, “Big PA gains”, “Needs binder work”.
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ============================
    // 1) EDIT YOUR STUDENT DATA HERE
    // ============================
    // Put your actual student names, XP, tiers, PA averages, and model file paths.
    // The model path is relative to this HTML file (e.g., "avatars/amelia.glb").

    const students = [
      {
        name: "Amelia",
        tier: "S",
        xp: 245,
        paAvg: 3.6,
        notes: "Consistent leadership in labs. Strong CER writing.",
        modelPath: "avatars/amelia.glb"
      },
      {
        name: "Bryan",
        tier: "A",
        xp: 180,
        paAvg: 3.1,
        notes: "Improving PA scores. Great peer support.",
        modelPath: "avatars/bryanavatar.glb"
      },
      {
        name: "Chris",
        tier: "B",
        xp: 130,
        paAvg: 2.8,
        notes: "On-task streak this month. Needs to turn in all PAs.",
        modelPath: "avatars/chris.glb"
      }
      // ➕ Add more students like this:
      // { name: "Student Name", tier: "C", xp: 90, paAvg: 2.5, notes: "Blah", modelPath: "avatars/student.glb" }
    ];

    // If you want a "max XP" reference for the progress bar, set it here:
    const maxXpForBar = 250; // adjust as needed

    // ============================
    // 2) UI Logic – no need to edit
    // ============================

    const studentListEl = document.getElementById("studentList");
    const searchInput = document.getElementById("searchInput");

    const avatarViewer = document.getElementById("avatarViewer");
    const viewerTierTag = document.getElementById("viewerTierTag");
    const viewerNameTag = document.getElementById("viewerNameTag");

    const infoName = document.getElementById("infoName");
    const infoTierChip = document.getElementById("infoTierChip");
    const infoSubtitle = document.getElementById("infoSubtitle");
    const infoXp = document.getElementById("infoXp");
    const xpBarFill = document.getElementById("xpBarFill");

    const statTier = document.getElementById("statTier");
    const statPaAvg = document.getElementById("statPaAvg");
    const statNotes = document.getElementById("statNotes");

    let activeIndex = null;

    function renderStudentList(filterText = "") {
      studentListEl.innerHTML = "";
      const lower = filterText.trim().toLowerCase();

      students.forEach((student, index) => {
        if (lower && !student.name.toLowerCase().includes(lower)) return;

        const pill = document.createElement("button");
        pill.type = "button";
        pill.className = "student-pill" + (index === activeIndex ? " active" : "");
        pill.dataset.index = index;

        const nameSpan = document.createElement("span");
        nameSpan.className = "student-name";
        nameSpan.textContent = student.name;

        const metaDiv = document.createElement("div");
        metaDiv.className = "student-meta";

        const tierSpan = document.createElement("span");
        tierSpan.className = "tier-chip tier-" + student.tier;
        tierSpan.textContent = student.tier + " tier";

        const xpSpan = document.createElement("span");
        xpSpan.textContent = student.xp + " XP";

        metaDiv.appendChild(tierSpan);
        metaDiv.appendChild(xpSpan);

        pill.appendChild(nameSpan);
        pill.appendChild(metaDiv);

        pill.addEventListener("click", () => selectStudent(index));

        studentListEl.appendChild(pill);
      });
    }

    function selectStudent(index) {
      activeIndex = index;
      const s = students[index];

      // Update 3D viewer
      avatarViewer.src = s.modelPath;
      viewerNameTag.textContent = s.name;
      viewerTierTag.textContent = "Tier: " + s.tier;

      // Update info text
      infoName.textContent = s.name;
      infoTierChip.textContent = "Tier " + s.tier;
      infoTierChip.className = "tier-chip tier-" + s.tier;

      infoSubtitle.textContent = "XP profile and performance overview.";

      infoXp.textContent = s.xp + " XP";

      const percent = Math.max(0, Math.min(100, (s.xp / maxXpForBar) * 100));
      xpBarFill.style.width = percent + "%";

      statTier.innerHTML = `<strong>Tier:</strong> ${s.tier}`;
      statPaAvg.innerHTML = `<strong>PA Avg:</strong> ${s.paAvg.toFixed(1)} / 4.0`;
      statNotes.textContent = s.notes || "No notes yet.";

      // Re-render list so active pill gets highlight
      renderStudentList(searchInput.value);
    }

    // Init
    renderStudentList();

    searchInput.addEventListener("input", () => {
      renderStudentList(searchInput.value);
    });
  </script>
</body>
</html>
